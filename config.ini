## ============================================================================
## AffinityServiceRust Configuration File
## ============================================================================
##
## This config file defines CPU affinity: priority: and scheduling rules for
## Windows processes. Customize the aliases below to match YOUR CPU topology.
##
## Logs are stored in logs/ directory by default for -processlogs mode.
##
## ----------------------------------------------------------------------------
## TERMINOLOGY
## ----------------------------------------------------------------------------
##   P-core  = Performance core (Intel hybrid CPUs)
##   E-core  = Efficiency core (Intel hybrid CPUs)
##   p       = P-core with HyperThreading OFF (1 thread per core)
##   pp      = P-core with HyperThreading ON (2 threads per core)
##   e       = E-core (always 1 thread per core)
##
## Example: Intel i7-14700KF with HT off = 8p + 12e = 20 logical processors
##
## ----------------------------------------------------------------------------
## CONFIG FORMAT
## ----------------------------------------------------------------------------
##   process_name:priority:affinity:cpuset:prime_cpus[@startModuleName1;startModuleName2]:io_priority:memory_priority
##
##   Field descriptions:
##     process_name  - Executable name (e.g.: game.exe)
##     priority      - Process priority class
##     affinity      - Hard CPU affinity mask (inherited by child processes)
##     cpuset        - Soft CPU preference via Windows CPU Sets
##     prime_cpus    - CPUs for prime thread scheduling (CPU-intensive threads). Optionally @prefix1;prefix2 to match start module names (default empty)
##     io_priority   - I/O priority level
##     memory_priority - Memory page priority
##
## ----------------------------------------------------------------------------
## CPU SPECIFICATION FORMATS
## ----------------------------------------------------------------------------
##   0           - Don't modify (keep current setting)
##   0-7         - CPU range: cores 0 through 7 (RECOMMENDED)
##   0;4;8       - Individual CPUs: cores 0: 4: and 8
##   0-7;64-71   - Multiple ranges: for >64 core systems
##   7           - Single CPU: core 7 only (NOT a bitmask!)
##   0xFF        - Hex bitmask: legacy format: ≤64 cores only
##   *alias      - Use predefined alias (e.g.: *pcore: *ecore)
##
##   NOTE: "7" means core 7: NOT a bitmask for cores 0-2.
##         Use "0x7" or "0-2" if you want cores 0: 1: and 2.
##
## ----------------------------------------------------------------------------
## PRIORITY LEVELS
## ----------------------------------------------------------------------------
##   priority:        none: idle: below normal: normal: above normal: high: real time
##   io_priority:     none: very low: low: normal: high (high requires admin)
##   memory_priority: none: very low: low: medium: below normal: normal
##
##   Use "none" to skip setting that attribute (keep Windows default).
##
## ----------------------------------------------------------------------------
## PROCESS GROUPS
## ----------------------------------------------------------------------------
##   Group multiple processes with the same rule using { } syntax.
##   Group name is optional (for documentation/debugging only):
##
##   # Named group (multi-line)
##   group_name {
##       process1.exe: process2.exe
##       # Comments allowed inside
##       process3.exe
##   }:priority:affinity:cpuset:prime_cpus[@prefixes]:io_priority:memory_priority
##
##   # Named group (single-line)
##   browsers { chrome.exe: firefox.exe }:normal:*e:0:0:low:none
##
##   # Anonymous group (no name)
##   { notepad.exe: calc.exe }:none:*e:0:0:low:none
##
## ----------------------------------------------------------------------------
## CPU ALIAS EXAMPLES (adjust for your CPU)
## ----------------------------------------------------------------------------
##   8p12e (20 cores)    8pp16e (32 threads)   6p8e (14 cores)
##   P-cores: 0-7        P-cores: 0-15         P-cores: 0-5
##   E-cores: 8-19       E-cores: 16-31        E-cores: 6-13
##   All:     0-19       All:     0-31         All:     0-13
##
## ============================================================================


# ==================== CONSTANTS ====================
# minimum consecutive active intervals before a thread can be promoted to prime
@MIN_ACTIVE_STREAK	=	2

# keep a previous prime thread prime when its delta_cycles is greater than constant * highest delta_cycles
@KEEP_THRESHOLD		=	0.69

# a candidate thread whose delta_cycles is greater than constant * highest delta_cycles could be prime thread
@ENTRY_THRESHOLD	=	0.42
# ===================================================

# Define affinity aliases
*a		=	0-19
*p		=	0-7
*e		=	8-19
*pN0	=	1-7
*pN01	=	2-7
*aN0	=	1-19
*aN01	=	2-19

# ==================== INDIVIDUAL PROCESS RULES ====================

# CS2: cpuset=P-cores: prime scheduling pins main threads to P-cores except 0-1
cs2.exe:normal:*p:0:*pN01@cs2.exe;nvwgf2umx.dll:normal:none

# SSJJ Battle Client
ssjj_battleclient_unity.exe:none:*pN01:0:0:normal:none

# MouseTester
MouseTester.exe:normal:*pN0:0:0:normal:none

# Desktop Window Manager - high priority on P-cores (requires admin for high IO)
dwm.exe:high:*p:0:0:high:none

# Parent processes that spawn many children - all cores: prefer E-cores
explorer.exe:none:*a:*e:0:none:none
steam.exe:below normal:*a:*e:0:low:none
taskhostw.exe:none:*a:*e:0:none:none

# Development tools - all cores: prefer P-cores except 0-1
idea64.exe:none:*a:*pN01:0:normal:none
devenv.exe:none:*a:*pN01:0:normal:none
boosterx.exe:none:*a:*pN01:0:normal:none

# Java runtime - all cores: prefer P-cores except 0-1
javaw.exe:normal:*a:*pN01:0:normal:none
java.exe:normal:*a:*pN01:0:normal:none

# Anti-cheat services - all cores: prefer E-cores
easyanticheat_eos.exe:none:*a:*e:0:normal:none
eaanticheat.gameservicelauncher.exe:below normal:*a:*e:0:normal:none
easteamproxy.exe:below normal:*a:*e:0:normal:none

# FurMark stress test
easyfmsi.exe:none:*a:*pN01:0:normal:none
fmsiscan.exe:none:*a:*pN01:0:normal:none

# ==================== GAME GROUPS ====================

# Games with normal priority - all cores: cpuset prefers P-cores except 0-1
games_normal {
    # Battlefield
    bf1.exe
    # Aim trainers
    FPSAimTrainer-Win64-Shipping.exe: aimlab_tb.exe
    # Survival
    raft.exe
    # Open world
    gta5_enhanced.exe
    # Battle royale
    tslgame.exe
}:normal:*a:*pN01:0:normal:none

# Games with passive priority (let OS manage priority) - all cores: cpuset prefers P-cores except 0-1
games_passive {
    # Battle royale
    tslgame_zk.exe
    # RPG
    starrail.exe
    # FPS
    crysis2remastered.exe
    # Benchmark
    3dmark.exe
    # Overclocking test
    occt.exe
    # Benchmark
    cinebench.exe
}:none:*a:*pN01:0:normal:none

# ==================== BACKGROUND PROCESS GROUPS ====================
# most of them run on E-cores only with low IO priority

# Windows system processes
windows {
    # text input
    textinputhost.exe: ctfmon.exe: chsime.exe
    # shell/UI
    dllhost.exe: sihost.exe: ShellHost.exe: fontdrvhost.exe: winlogon.exe: wmiprvse.exe: applicationframehost.exe
    # search
    searchhost.exe: searchindexer.exe: searchprotocolhost.exe: searchfilterhost.exe
    # update
    usoclient.exe: waasmedicagent.exe: mousocoreworker.exe: updateplatform.amd64fre.exe: mpsigstub.exe: wuaucltcore.exe: am_delta_patch_1.437.174.0.exe
    # gamebar
    xboxgamebarwidgets.exe: xboxpcappft.exe: gamebarftserver.exe: gamebarpresencewriter.exe: gamebar.exe
    # terminal
    windowsterminal.exe: openconsole.exe: cmd.exe: conhost.exe
    # powershell
    powershell.exe: powershell_ise.exe
    # powertoys
    powertoys.peek.ui.exe: powertoys.alwaysontop.exe: powertoys.fancyzones.exe: powertoys.exe
    # crash handlers
    crashpad_handler.exe: unitycrashhandler64.exe: mmcrashpad_handler64.exe: werfault.exe
    # utilities
    wevtutil.exe: sc.exe: wmiapsrv.exe: photos.exe: regedit.exe: notepad.exe
    cloudexperiencehostbroker.exe: sppextcomobj.exe: pickerhost.exe: comppkgsrv.exe
    sechealthui.exe: dashost.exe: wwahost.exe: appactions.exe: ping.exe
    cliprenew.exe: wmiadap.exe: ngciso.exe: accountscontrolhost.exe: lockapp.exe
    credentialuibroker.exe: msiexec.exe: securityhealthsystray.exe: smartscreen.exe
    tabtip.exe: useroobebroker.exe: systemsettings.exe: snippingtool.exe
    # On-screen keyboard
    osk.exe
    calculatorapp.exe: calc.exe: taskmgr.exe: systempropertiesadvanced.exe
    crossdeviceresume.exe: backgroundtransferhost.exe: backgroundtaskhost.exe
    startmenuexperiencehost.exe
}:none:*e:0:0:low:none

# Web Browsers
browsers {
    chrome.exe: msedge.exe
    # Chrome elevation service
    elevation_service.exe
    # Chrome platform helper
    platform_experience_helper.exe
}:none:*e:0:0:low:none

# Streaming & recording tools
stream_tools {
    # OBS Studio
    obs64.exe: obs-ffmpeg-mux.exe
    # Bilibili streaming
    bililive_browser.exe: livehime.exe
    # Steam overlay
    gameoverlayui64.exe: gameoverlayui.exe
}:none:*e:0:0:low:none

# Proxy & network tools
proxy_tools {
    # clash
    clash for windows.exe
    # sing-box
    sing-box.exe
    # xray/v2ray
    xray.exe: v2rayn.exe
    # sakura frp
    sakuralauncher.exe: sakurafrpservice.exe: frpc.exe
    # leigod accelerator
    networktunnel_proxy.exe: leishensdk.exe: leigod.exe
    # usbeam p2p lan
    usbeam_lan_party_v1.2.exe
    # discord proxy
    discordproxystart.exe
    # Qiyou
    qeetm.exe
    # Network analyzer
    wireshark.exe
    # Wireshark packet capture
    dumpcap.exe
    # Download manager
    aria2c.exe
}:none:*e:0:0:low:none

# Hardware drivers & services
hardware {
    # ASUS services
    asuscertservice.exe: rogliveservice.exe: ledcontrolservice3.exe: acpowernotification.exe
    armourysocketserver.exe: asusupdate.exe: armourycrate.exe: asus_framework.exe
    armouryswagent.exe: armouryaudioagent.exe: armourycrate.service.exe
    armourycrate.usersessionhelper.exe: fileoperator.exe: taskschedulertool_armourysocketserver.exe
    # Intel Platform Framework
    ipf_uf.exe: platformlicensemanagerservice.exe: ipfsvc.exe: jhi_service.exe: wmiregistrationservice.exe: ipf_helper.exe
    # iRok keyboard
    irok.exe: driver.service.exe: irok_ast_embed.exe
    # Intel service
    jhi_service.exe
    # VGN Hub
    vgn hub.exe: vgn-service.exe
    # NVIDIA
    dbinstaller.exe: nvngx_update.exe: nvoawrappercache.exe: nvrla.exe: nvfvsdksvc_x64.exe: nvcontainer.exe: nvidia overlay.exe: nvsphelper64.exe
    fvcontainer.system.exe: fvcontainer.exe: presentmon_x64.exe
    # Rapoo a hub
    a hub.exe
}:none:*e:0:0:low:none

# Wallpaper Engine
wallpaper {
    wallpaper64.exe: wallpaper32.exe: ui32.exe: winrtutil32.exe
}:none:*e:0:0:low:none

# Development tools
dev_tools {
    # Git
    link.exe: sed.exe: git-remote-https.exe: basename.exe: sh.exe: git.exe
    # JetBrains IDE
    full-line-inference.exe: embeddings-server.exe: lldbfrontend.exe: intellij-rust-native-helper.exe
    rust-analyzer-proc-macro-srv.exe: rustc.exe: rustup-init.exe: cargo.exe: fsnotifier.exe: cef_server.exe: rustrover-2025.2.1.exe
    # Visual Studio
    enablegraphicstools.exe: perfwatson2.exe: microsoft.servicehub.controller.exe
    servicehub.vsdetouredhost.exe: servicehub.identityhost.exe: servicehub.threadedwaitdialog.exe
    servicehub.testwindowstorehost.exe: servicehub.intellicodemodelservice.exe: servicehub.indexingservice.exe
    servicehub.host.dotnet.x64.exe: vshost.exe: mspdbsrv.exe: vctip.exe: vcpkgsrv.exe: tracker.exe: msbuild.exe
    # Helix editor
    hx.exe: helix.exe
    # Notepad++
    notepad++.exe: gup.exe
    # Hex editor
    imhex-gui.exe
    # Presentation tool
    zoomit64.exe
    # Text editor
    vim.exe
    # GitHub MCP server
    github-mcp-server.exe
    # VS Roslyn service
    servicehub.roslyncodeanalysisservice.exe
}:none:*e:0:0:low:none

# Office suites
office {
    # Microsoft Office
    integrator.exe: officec2rclient.exe: actionsserver.exe: opushutil.exe: sdxhelper.exe
    appvshnotify.exe: msosync.exe: officeclicktorun.exe: filecoauth.exe: winword.exe
    # WPS Office
    kvpins64.exe: promecefpluginhost.exe: wpscloudsvr.exe: wpspdf.exe: wps.exe
    # Paint app
    mspaint.exe
}:none:*e:0:0:low:none

# Chat & social apps
chat_apps {
    # WeChat
    weixin.exe: wechatocr.exe: wechatutility.exe: wechatplayer.exe: wechatappex.exe: wechat.exe
    # QQ
    qq.exe
    # Discord
    discord.exe
    # Telegram
    telegram.exe
    # oopz
    oopz.exe
}:none:*e:0:0:low:none

# Game platforms & launchers
game_platforms {
    # EA
    ealocalhostsvc.exe: eacefsubprocess.exe: eadesktop.exe: eabackgroundservice.exe
    # Rockstar
    rockstarerrorhandler.exe: socialclubhelper.exe: rockstarservice.exe
    # miHoYo
    launcher.exe: hyp.exe: zfgamebrowser.exe: hyphelper.exe
    # B5 Platform
    b5csgo.exe: b5gameserviceloader.exe: b5gameservice.exe
    # Faceit
    faceitclient.exe: faceitservice.exe
    # PUBG / BattlEye
    beservice.exe: zksvc.exe: execpubg.exe: tslgame_be.exe
    # 5E / Perfect World
    5eclient.exe: bucky64.exe: 完美世界竞技平台.exe
    # Other Launchers
    ssjj2microclient.exe: wdlauncher.exe: plain craft launcher 2.exe
    # Steam community
    steamcommunity_302.exe
    # Epic Games helper
    epicwebhelper.exe
}:none:*e:0:0:low:none

# Media apps
media_apps {
    # Adobe
    adobe crash processor.exe: adobeipcbroker.exe: ccxprocess.exe
    # NetEase Music
    orpheus_install.exe: cloudmusic.exe: cloudmusic_reporter.exe
    # PotPlayer
    potplayermini64.exe
    # Codecs
    madhcctrl.exe
    # Torrent client
    qbittorrent.exe
}:none:*e:0:0:low:none

# System utilities
sys_utils {
    # Process Lasso
    bitsumsessionagent.exe: processgovernor.exe: processlasso.exe
    # AffinityService
    affinityservicerust.exe: affinityserverc.exe
    # 来掌芯
    来掌芯.exe
    # Tools
    pixpin.exe: update.exe: gpservice.exe
    # Mouse tester
    mousetester.exe
    # PsExec service
    psexesvc.exe
}:none:*e:0:0:low:none

# ==================== INDIVIDUAL E-CORE RULES ====================
# Background processes on E-cores that need individual settings (different IO/priority)

# FPSAimTrainer parent process for Kovvak's FPSAimTrainer
FPSAimTrainer.exe:none:*e:0:0:low:none
# FPSAimTrainer son process for Kovvak's FPSAimTrainer
UnrealCEFSubProcess.exe:none:*e:0:0:low:none
# SetTimerResolution.exe
SetTimerResolution.exe:none:*e:0:0:low:none
# Timer resolution setter
timerresolution.exe:none:*e:0:0:low:none
# Timer benchmarking
timerbench.exe:none:*e:0:0:low:none
# Mouse tester
mousetesterrust.exe:normal:*pN0:0:0:normal:none
# NVDisplay Container (for control pannel or Nvidia APP) - different IO setting
NVDisplay.Container.exe:none:*e:0:0:none:none
# VS code
code.exe:none:*e:0:0:low:none
# clash for windows core network IO serve - needs normal IO
clash-win64.exe:none:*e:0:0:normal:none
# code language rust's code analyzer
rust-analyzer.exe:none:*e:0:0:low:none
# windows 错误报告收集器 - very low IO
wermgr.exe:none:*e:0:0:very low:none
# Windows 打印 - idle priority
spoolsv.exe:idle:*e:0:0:low:none
# windows audiodg - needs above normal priority
audiodg.exe:above normal:*e:0:0:low:none
# microsoft edge 相关组件
identity_helper.exe:none:*e:0:0:low:none
# b5csgo google 雷神加速器 OBS telegram 等的更新程序
updater.exe:none:*e:0:0:low:none
# 后台下载
backgrounddownload.exe:none:*e:0:0:low:none
# 系统还原 (system restore) 相关的计划任务后台进程
srtasks.exe:none:*e:0:0:low:none
# 阿里 通义
lingma.exe:none:*e:0:0:low:none
# office tool plus
office tool plus.exe:none:*e:0:0:low:none
# aimlab_tb webview
vuplex webview.vuplex:none:*e:0:0:low:none
# node.js 运行时环境  常用于运行各种 javascript 应用或工具
node.exe:none:*e:0:0:low:none
# aimlab_tb 崩溃处理动态链接库
crashpad_handler.dll:none:*e:0:0:low:none
# microsoft edge webview2 的进程  常用于在应用中嵌入 edge 浏览器功能
msedgewebview2.exe:none:*e:0:0:low:none
# 系统监控工具 system informer 的主进程
systeminformer.exe:none:*e:0:0:low:none
# steam 平台的服务进程
steamservice.exe:none:*e:0:0:low:none
# microsoft edge 的更新进程
microsoftedgeupdate.exe:none:*e:0:0:low:none
# onedrive 云存储客户端
onedrive.exe:none:*e:0:0:low:none
# steam 客户端的网页辅助进程
steamwebhelper.exe:none:*e:0:0:low:none
# qt webengine 的渲染进程  常用于基于 qt 的应用  如b5csgo  原神等等
qtwebengineprocess.exe:none:*e:0:0:low:none
# edge gameassist
edgegameassist.exe:none:*e:0:0:low:none
# smartscreen
chxsmartscreen.exe:none:*e:0:0:low:none
# winstore app
winstore.app.exe:none:*e:0:0:low:none
# winstore app extension
storedesktopextension.exe:none:*e:0:0:low:none
# 文件搜索工具 everything 的主进程
everything.exe:none:*e:0:0:low:none
# codelldb
codelldb.exe:none:*e:0:0:low:none
# clangd
clangd.exe:none:*e:0:0:low:none
# custombuildtool for systeminformer
custombuildtool.exe:none:*e:0:0:low:none
# github copilot 的语言服务器
copilot-language-server.exe:none:*e:0:0:low:none
# microsoft 管理控制台
mmc.exe:none:*e:0:0:low:none
# 微星 afterburner 监控和超频工具
msiafterburner.exe:none:*e:0:0:low:none
# microsoft 离线文件同步工具
mobsync.exe:none:*e:0:0:low:none
# bitlocker 加密服务
bdeuisrv.exe:none:*e:0:0:low:none
# rust 工具链安装器 - very low IO
rustup.exe:none:*e:0:0:very low:none
